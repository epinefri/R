---
title: "Fitness tracker case study in R"
author: "Daniela"
date: "2022-10-30"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

Bellabeat is a company that manufactures health-focused smart devices. The objective of the case study is to analyze smart device data to gain insight into how consumers are using their smart devices. The insights will then help guide the marketing strategy for the company.

#### Starting points:

-   Investigating data from products with similar functionality
-   Identify usage trends
-   Help Bellabeat identify potential weaknesses and inspire ideas on new functions or products

## Data sources

-   FitBit Fitness Tracker Data
    -   The dataset was downloaded from Kaggle (made available by [Mobius](https://www.kaggle.com/arashnic))
    -   The dataset is under CC0: Public Domain licence
    -   The data contains the personal fitness tracker data of thirty Fitbit users.
    -   Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. It includes information about daily activity, steps, and heart rate that can be used to explore users' habits.
    -   The datasets were generated by collecting the responses to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016.
    -   The dataset consists of 18 .csv files.
        -   note: MET is the metabolic equivalent of task or simply metabolic equivalent. It is a physiological measure expressing the energy cost (or calories) of physical activities. While exercising, the MET equivalent is the energy expended compared to rest, so MET values indicate the intensity.

## Data processing

#### Libraries

```{r}
library(tidyverse)
library(ggplot2)
```

#### Upload data

Selected 4 out of 18 csv files:

```{r}
dailyActivity <- read_csv("data/selected/dailyActivity.csv", show_col_types = FALSE)

heartrate_seconds <- read_csv("data/selected/heartrate_seconds.csv", show_col_types = FALSE)

sleepDay <- read_csv("data/selected/sleepDay.csv", show_col_types = FALSE)

weightLogInfo <- read_csv("data/selected/weightLogInfo.csv", show_col_types = FALSE)

```

Preview:

```{r}
glimpse(dailyActivity)
```

```{r}
glimpse(heartrate_seconds)
```

```{r}
glimpse(sleepDay)
```

```{r}
glimpse(weightLogInfo)
```

### Data cleaning

Check values from sleepDay table
```{r}
# sleepDay %>% 
  #group_by(Id) %>% 
  #summarize(count(SleepDay))

table(sleepDay$Id)
```
9 out of 24 individuals have under 10 inputs.

## Data analysis

Created a new data frame to summarize average values for each Id:

* Activity Summary: mean total steps, distance, sedentary minutes and calorie intake for each Id
```{r}
ActivitySummary <- dailyActivity %>% 
  group_by(Id) %>% 
  summarize(meanTotalSteps = mean(TotalSteps),
            meanTotalDistance = mean(TotalDistance),
            meanSedentaryMinutes = mean(SedentaryMinutes),
            meanCalorieIntake = mean(Calories))
```

* Heart rate summary: mean, min, max, median value of heart rate
```{r}
HeartrateSummary <- heartrate_seconds %>% 
  group_by(Id) %>% 
  summarize(meanBPM = mean(Value),
            minBPM = min(Value),
            maxBPM = max(Value),
            medBPM = median(Value))
```

* Sleep summary: average minutes of sleep, average minutes to fall asleep
```{r}
SleepSummary <- sleepDay %>% 
  mutate(fallAsleep = TotalTimeInBed - TotalMinutesAsleep) %>% 
  group_by(Id) %>% 
  summarize(meanSleepTime = mean(TotalMinutesAsleep),
            meanFallAsleep = mean(fallAsleep))
```

```{r}

```


* Observations:
  * Activity data was collected for 33 individual ids (although the number of participants is supposed to be thirty)
  * Heart rate data was collected for 14 individuals (could give unreliable analysis results)
  * Sleep data was collected for 24 individuals 
  
  
## Visualization

#### The relationship between 

```{r}
ggplot(data = dailyActivity, mapping = aes(x = Calories, y = SedentaryMinutes)) + geom_point()
```
