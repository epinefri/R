---
title: "Fitness tracker case study in R"
author: "Daniela"
date: "2022-10-30"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

Bellabeat is a company that manufactures health-focused smart devices. The objective of the case study is to analyze smart device data to gain insight into how consumers are using their smart devices. The insights will then help guide the marketing strategy for the company.

#### Starting points:

-   Investigating data from products with similar functionality
-   Identify usage trends
-   Help Bellabeat identify potential weaknesses and inspire ideas on new functions or products

## Data sources

-   FitBit Fitness Tracker Data
    -   The dataset was downloaded from Kaggle (made available by [Mobius](https://www.kaggle.com/arashnic))
    -   The dataset is under CC0: Public Domain licence
    -   The data contains the personal fitness tracker data of thirty Fitbit users.
    -   Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. It includes information about daily activity, steps, and heart rate that can be used to explore users' habits.
    -   The datasets were generated by collecting the responses to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016.
    -   The dataset consists of 18 .csv files.
        -   note: MET is the metabolic equivalent of task or simply metabolic equivalent. It is a physiological measure expressing the energy cost (or calories) of physical activities. While exercising, the MET equivalent is the energy expended compared to rest, so MET values indicate the intensity.

## Data processing

#### Libraries

```{r}
library(tidyverse)
library(ggplot2)
```

#### Upload data

Selected 4 out of 18 csv files:

```{r}
dailyActivity <- read_csv("data/selected/dailyActivity.csv", show_col_types = FALSE)

heartrate_seconds <- read_csv("data/selected/heartrate_seconds.csv", show_col_types = FALSE)

sleepDay <- read_csv("data/selected/sleepDay.csv", show_col_types = FALSE)

weightLogInfo <- read_csv("data/selected/weightLogInfo.csv", show_col_types = FALSE)

```

Preview:

```{r}
glimpse(dailyActivity)
```

```{r}
glimpse(heartrate_seconds)
```

```{r}
glimpse(sleepDay)
```

```{r}
glimpse(weightLogInfo)
```
 * only two entries of fat percentage, insufficient for analysis
 
### Data cleaning

Check the number of submitted values from SleepDay table
```{r}
table(sleepDay$"Id")
```
15 out of 24 individuals have more than 10 recorded days; 
Create a new table to only use data from those 15 users:

```{r}
# create a table containing only ids of users with more than 10 entries

SleepSummaryIds <- sleepDay %>% 
  group_by(Id) %>% 
  count(unique("Id"), sort = TRUE) %>% 
  filter(n > 10)

as_tibble(SleepSummaryIds)
```

Join the ids table with the sleepDay table:
```{r}
SleepFiltered <- sleepDay %>% right_join(SleepSummaryIds, by="Id")
as_tibble(SleepFiltered)
  
```

Check the weightLogInfo number of inputs:
```{r}
table(weightLogInfo$Id)
```
  * Only 8 users submitted weight data, and only 2 of them have more than 5 entries.
  
## Data analysis

Created a new data frame to summarize average values for each Id:

* Activity Summary: mean total steps, distance, sedentary minutes and calorie intake for each Id
```{r}
ActivitySummary <- dailyActivity %>% 
  group_by(Id) %>% 
  summarize(meanTotalSteps = mean(TotalSteps),
            meanTotalDistance = mean(TotalDistance),
            meanSedentaryMinutes = mean(SedentaryMinutes),
            meanCalorieIntake = mean(Calories))
```

* Heart rate summary: mean, min, max, median value of heart rate
```{r}
HeartrateSummary <- heartrate_seconds %>% 
  group_by(Id) %>% 
  summarize(meanBPM = mean(Value),
            minBPM = min(Value),
            maxBPM = max(Value),
            medBPM = median(Value))
```

* Sleep summary: average minutes of sleep, average time spent in bed
```{r}
SleepSummary <- SleepFiltered %>% 
  group_by(Id) %>% 
  summarize(meanSleepTime = mean(TotalMinutesAsleep),
            meanTimeInBed = mean(TotalTimeInBed))
```

*Weight summary: average weight, BMI
```{r}
WeightSummary <- weightLogInfo %>% 
  group_by(Id) %>% 
  summarize(meanWeightKg = mean(WeightKg),
            meanBMI = mean(BMI))
```


Drop unnecessary columns (only keep summaries)
```{r}
remove(dailyActivity);
remove(heartrate_seconds);
remove(sleepDay);
remove(SleepFiltered); 
remove(SleepSummaryIds); 
remove(weightLogInfo);
```


* Observations:
  * Activity data was collected for 33 individual ids (although the number of participants is said to be thirty)
  * Heart rate data was collected for 14 individuals
  * Sleep data was collected for 24 individuals, of which 15 were selected for analysis (having more than 10 unique entries)
  * Weight data was collected for 8 individuals
  
  
## Visualization

#### The relationship between 

```{r}
ggplot(data = dailyActivity, mapping = aes(x = Calories, y = SedentaryMinutes)) + geom_point()
```
